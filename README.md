# Проект 2 - DWH: Пересмотр модели данных

## Описание проекта
Необходимо сделать миграцию в отдельные логические таблицы, а затем собрать на них витрину данных. 
Это поможет оптимизировать нагрузку на хранилище и позволит аналитикам, перед которыми стоит задача построить анализ эффективности и прибыльности бизнеса, 
отвечать на точечные вопросы о тарифах вендоров, стоимости доставки в разные страны, количестве доставленных заказов за последнюю неделю.
Если искать эти данные в таблице исходных логов доставки, нагрузка на хранилище будет не оптимальна. 
Придется усложнять запросы, что может привести к ошибкам.

Заказ в интернет-магазине — это набор купленных товаров и их количество. Покупатели привыкли получать заказы одномоментно, поэтому каждый заказ из набора товаров формируется в одну сущность доставки.
Интернет-магазину важно видеть, что сроки доставки соблюдаются, а её стоимость соответствует тарифам. 
Он платит за доставку самостоятельно, и стоимость доставки меняется в зависимости от страны — это базовая сумма, которую учитывает вендор. 
По договору он дополнительно получает прибыль за счет комиссии от вендора.
Но сейчас эти данные хранятся в одной таблице, shipping, где много дублирующейся и несистематизированной справочной информации. 
По сути там содержится весь лог доставки от момента оформления до выдачи заказа покупателю.


## Ход решения задачи

1. Структура исходных данных, требования к таблицам миграции и представлению для аналитики находится в requirements.md

2. Миграция данных в отдельные логические таблицы

    2.1 Создание справочника стоимости доставки в страны (shipping_country_rates).

	2.1.1 Заполнение справочника shipping_country_rates.

    2.2 Создание справочника тарифов доставки вендора по договору (shipping_agreement).

	2.2.1 Заполнение справочника shipping_agreement.

    2.3 Создание справочника о типах доставки (shipping_transfer).

	2.3.1 Заполнение справочника shipping_transfer.

    2.4 Создание таблицы shipping_info, с данными уникальных доставок shippingid.

	2.4.1 Заполнение таблицы shipping_info.

    2.5 Создание таблицы статусов о доставке shipping_status.

	2.5.1 Заполнение таблицы shipping_info.

  #### Код создания таблиц(справочников) находится в ddl_migration_tables.sql

  #### Код заполнения таблиц находится в complete_migration_tables.sql

  #### Код проверок(так же, тестового создания и заполнения таблиц) находится в migration_from_shipping_check.sql

3. Создание представления shipping_datamart на основании готовых таблиц

  #### Создание представления shipping_datamart находится в shipping_datamart_creating_view.sql

  #### Код проверок представления shipping_datamart находится в migration_from_shipping_check.sql